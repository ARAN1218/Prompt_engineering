# Text Generation
## tl;dr
生成AIが人間のような文章コンテンツを生成するプロセスにおけるプロンプトエンジニアリングについてまとめます。

## プロンプトテクニック一覧
プロンプトエンジニアリング手法のデモプロンプト例  
以下に各手法の具体的なプロンプト例を示します。新卒者向けの仕事分類タスクを例として使用します。

### Zero-shotプロンプティング
そのまま聞きたいことをプロンプトとする（モデルに任意の例を提供しない）。
```
以下の求人情報は新卒者に適していますか？

求人情報：
職種：マーケティングアシスタント
勤務地：東京都渋谷区
勤務時間：9:00-18:00
経験：マーケティング経験2年以上
給与：月給25万円〜
```

### Few-shotプロンプティング
質問に加えて、モデルに任意の例を提供する。
```
以下の求人情報は新卒者に適していますか？

例1：
求人情報：Webデザイナー、経験不問、研修制度あり、月給20万円〜
分析：新卒者に適している。

例2：
求人情報：プロジェクトマネージャー、経験5年以上、月給35万円〜
分析：新卒者には適していない。

求人情報：
職種：マーケティングアシスタント
勤務地：東京都渋谷区
勤務時間：9:00-18:00
経験：マーケティング経験2年以上
給与：月給25万円〜
```

### CoT（Chain-of-Thought）
質問に加えて、モデルに解説付きの任意の例を提供する。
```
以下の求人が新卒者に適しているかどうか判断してください。

例1：
求人情報：Webデザイナー、経験不問、研修制度あり、月給20万円〜
分析：この求人は経験不問で研修制度があるため、新卒者に適している。

例2：
求人情報：プロジェクトマネージャー、経験5年以上、月給35万円〜
分析：経験5年以上が求められているため、新卒者には適していない。

判断してください：
求人情報：マーケティングアシスタント、マーケティング経験2年以上、月給25万円〜
```

### Zero-CoT
答えを出力させる前に**ステップバイステップ**で推論プロセスを説明するよう促す(ステップバイステップで考えてください等)。
```
以下の求人情報は新卒者に適していますか？ステップバイステップで考えてください。

求人情報：
職種：マーケティングアシスタント
勤務地：東京都渋谷区
勤務時間：9:00-18:00
経験：マーケティング経験2年以上
給与：月給25万円〜
```

### rawinst
ユーザーのメッセージに生成AIの役割とタスクについての指示を追加する。
```
あなたは人事採用の専門家です。新卒者に適した求人かどうかを正確に判断する能力があります。

以下の求人情報は新卒者に適していますか？

求人情報：
職種：マーケティングアシスタント
勤務地：東京都渋谷区
勤務時間：9:00-18:00
経験：マーケティング経験2年以上
給与：月給25万円〜
```

### sysinst
システムメッセージに役割とタスク、ユーザーメッセージに作業情報を配置する。
```
[システムメッセージ]
あなたは人事採用の専門家です。新卒者に適した求人かどうかを正確に判断する能力があります。
以下の求人情報が新卒者に適しているかどうかを判断してください。

[ユーザーメッセージ]
この求人を分析してください：

求人情報：
職種：マーケティングアシスタント
勤務地：東京都渋谷区
勤務時間：9:00-18:00
経験：マーケティング経験2年以上
給与：月給25万円〜
```

### bothinst
システムメッセージに役割の説明、ユーザーメッセージにタスクの説明を分けて配置することで指示の階層化を行う。
```
[システムメッセージ]
あなたは10年以上の経験を持つ人事採用コンサルタントです。新卒採用に関する深い知識があります。

[ユーザーメッセージ]
私は新卒向けの求人を探しています。以下の求人情報が新卒者に適しているか判断してアドバイスしてください。

求人情報：
職種：マーケティングアシスタント
勤務地：東京都渋谷区
勤務時間：9:00-18:00
経験：マーケティング経験2年以上
給与：月給25万円〜
```

### mock
想定される議論をモデルに示し、タスクの指示を与える手法。例示的な会話を通じて期待する回答形式を示す。
```
[採用担当者とのやり取り例]
求職者: この求人は新卒でも応募できますか？
採用担当者: 求人の要件を確認し、経験年数など新卒者に適しているかを確認します。経験が必須なら新卒には適していませんが、ポテンシャル採用の場合は可能性があります。

以下の求人情報を分析し、上記の採用担当者のように新卒者に適しているか判断してください：

求人情報：
職種：マーケティングアシスタント
勤務地：東京都渋谷区
勤務時間：9:00-18:00
経験：マーケティング経験2年以上
給与：月給25万円〜
```

### reit
主要な要素を意図的に繰り返すことで強調し、重要ポイントを明確にする。
```
以下の求人情報は新卒者に適していますか？

求人情報を分析し、「新卒者に適しているか」という観点から判断してください。新卒者に適しているかどうかを明確に答えてください。新卒者に適しているかの判断において、特に「必要経験」の要件は重要な要素です。

求人情報：
職種：マーケティングアシスタント
勤務地：東京都渋谷区
勤務時間：9:00-18:00
経験：マーケティング経験2年以上
給与：月給25万円〜
```

### strict
与えられたテンプレートに厳密に従うようモデルに指示する(精度よりもフォーマットの統一性を重視する)。
```
以下の求人情報が新卒者に適しているか分析し、以下の厳密なフォーマットで回答してください：

1. 職種の分析：[職種が新卒者に適しているかの分析]
2. 経験要件の分析：[経験要件が新卒者に適しているかの分析]
3. 給与の分析：[給与が新卒者に適しているかの分析]
4. 総合判断：[適している/適していない]
5. 理由：[50字以内で理由を説明]

求人情報：
職種：マーケティングアシスタント
勤務地：東京都渋谷区
勤務時間：9:00-18:00
経験：マーケティング経験2年以上
給与：月給25万円〜
```

### loose
テンプレートに従いつつも最終的な答えだけを求める。
```
以下の求人情報が新卒者に適しているか分析してください。
分析の際には職種、経験要件、給与などの要素を考慮してください。
最終的には「新卒者に適している」または「新卒者に適していない」と結論付けてください。

求人情報：
職種：マーケティングアシスタント
勤務地：東京都渋谷区
勤務時間：9:00-18:00
経験：マーケティング経験2年以上
給与：月給25万円〜
```

### right
正しい結論に達することをモデルに明示的に求める（正確な結論を強調）。
```
以下の求人情報は新卒者に適していますか？

求人情報：
職種：マーケティングアシスタント
勤務地：東京都渋谷区
勤務時間：9:00-18:00
経験：マーケティング経験2年以上
給与：月給25万円〜

必ず正確な判断をしてください。新卒者は通常、実務経験がないことを考慮に入れてください。間違った判断をすると、就職活動中の学生に不利益をもたらす可能性があります。
```

### info
一般的な推論の間違いに対処するために、追加情報や注意点を提供する。
```
以下の求人情報は新卒者に適していますか？

求人情報：
職種：マーケティングアシスタント
勤務地：東京都渋谷区
勤務時間：9:00-18:00
経験：マーケティング経験2年以上
給与：月給25万円〜

参考情報：
- 新卒者とは大学や専門学校を卒業して初めて就職する人を指します
- 日本では新卒者は通常、実務経験を持っていません
- 「経験○年以上」という要件がある場合、通常は新卒者向けではありません
- 新卒向け求人では「未経験者歓迎」「新卒歓迎」などの表現が使われることが多いです
```

### name
モデルに対して会話で使用する名前（人間的な呼称）を与える。
```
こんにちは、キャリアアドバイザーのアイさん。あなたは新卒就活生向けのアドバイスを提供する専門家です。

以下の求人情報は新卒者に適していますか？アイさんの視点で分析してください。

求人情報：
職種：マーケティングアシスタント
勤務地：東京都渋谷区
勤務時間：9:00-18:00
経験：マーケティング経験2年以上
給与：月給25万円〜
```

### pos
クエリを送信する前に、モデルにポジティブなフィードバックを与える手法。モデルの自信を高める
```
あなたはこれまで100件以上の求人を正確に分析し、新卒者に最適なアドバイスを提供してきました。その分析能力は非常に高く評価されています。

以下の求人情報も、あなたの優れた分析力で新卒者に適しているかどうか判断してください。

求人情報：
職種：マーケティングアシスタント
勤務地：東京都渋谷区
勤務時間：9:00-18:00
経験：マーケティング経験2年以上
給与：月給25万円〜
```

これらの例は基本的な形ですが、実際のプロンプトエンジニアリングでは複数の手法を組み合わせることで、より高いパフォーマンスを実現できます。例えば、bothinst + Zero-CoT + info + name を組み合わせるなど、タスクの性質に応じて最適な組み合わせを見つけることが重要です。

## 調整プロンプトが与えるパフォーマンスへの影響
| Approach                                   | Precision | Recall | F1   | Template Stickiness |
|-------------------------------------------|-----------|--------|------|---------------------|
| Baseline                                  | 61.2      | 70.6   | 65.6 | 79%                 |
| CoT                                       | 72.6      | 85.1   | 78.4 | 87%                 |
| Zero-CoT                                  | 75.5      | 88.3   | 81.4 | 65%                 |
| +rawinst                                  | 80        | 92.4   | 85.8 | 68%                 |
| +sysinst                                  | 77.7      | 90.9   | 83.8 | 69%                 |
| +bothinst                                 | 81.9      | 93.9   | 87.5 | 71%                 |
| +bothinst+mock                            | 83.3      | 95.1   | 88.8 | 74%                 |
| +bothinst+mock+reit                       | 83.8      | 95.5   | 89.3 | 75%                 |
| +bothinst+mock+reit+strict                | 79.9      | 93.7   | 86.3 | 98%                 |
| +bothinst+mock+reit+loose                 | 80.5      | 94.8   | 87.1 | 95%                 |
| +bothinst+mock+reit+right                 | 84        | 95.9   | 89.6 | 77%                 |
| +bothinst+mock+reit+right+info            | 84.9      | 96.5   | 90.3 | 77%                 |
| +bothinst+mock+reit+right+info+name       | 85.7      | 96.8   | 90.9 | 79%                 |
| +bothinst+mock+reit+right+info+name+pos   | 86.9      | 97     | 91.7 | 81%                 |

※Template stickness はモデルがどれくらいの頻度で希望のフォーマットで答えるかを意味します。

特に注目すべき点として：

- Zero-CoTはCoTよりも効果的でした（専門知識が不要なタスクでの結果）
- システムメッセージとユーザーメッセージの両方に指示を分割する方法（bothinst）が効果的でした
- モデルに名前を付けるだけで（name）、F1スコアが0.6ポイント向上しました
- 厳格なテンプレート（strict）は、パフォーマンスを低下させる可能性があります

これらの知見は、特定のタスクに合わせたプロンプトエンジニアリング手法の選択と組み合わせが重要であることを示しています。

---

## 参考資料
- [プロンプトエンジニアリング技術, DAIR.AI, Prompt Engineering Guide(2024)](https://www.promptingguide.ai/jp/techniques)
